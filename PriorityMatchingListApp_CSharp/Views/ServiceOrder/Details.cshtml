@model ServiceOrder
@{
    ViewData["Title"] = "Service Order Details - PriorityMatchingList";
}

<div class="container-fluid mt-4">
    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb" class="mb-4">
        <ol class="breadcrumb shadow-sm">
            <li class="breadcrumb-item">
                <a asp-action="Index" class="text-decoration-none">
                    <i class="fas fa-clipboard-list"></i> My Service Orders
                </a>
            </li>
            <li class="breadcrumb-item active" aria-current="page">
                <i class="fas fa-eye"></i> Order #@Model.ServiceOrderID
            </li>
        </ol>
    </nav>

    <!-- Main Details Card -->
    <div class="card fade-in">
        <div class="card-header">
            <h4><i class="fas fa-clipboard-check"></i> Service Order Details - #@Model.ServiceOrderID</h4>
        </div>
        <div class="card-body">
            <div class="row">
                <!-- Service Order Information -->
                <div class="col-lg-6">
                    <div class="card shadow-sm h-100">
                        <div class="card-body">
                            <h5 class="text-gradient mb-4">
                                <i class="fas fa-info-circle"></i> Service Order Information
                            </h5>
                            
                            <div class="detail-group mb-3">
                                <label class="detail-label">
                                    <i class="fas fa-building"></i> Account Name
                                </label>
                                <div class="detail-value-box">@Model.AccountName</div>
                            </div>
                            
                            <div class="detail-group mb-3">
                                <label class="detail-label">
                                    <i class="fas fa-map-marker-alt"></i> Location
                                </label>
                                <div class="detail-value-box">@(Model.Location ?? "Not specified")</div>
                            </div>
                            
                            <div class="detail-group mb-3">
                                <label class="detail-label">
                                    <i class="fas fa-user-tie"></i> CC & Role
                                </label>
                                <div class="detail-value-box">@(Model.CCArole ?? "Not specified")</div>
                            </div>
                            
                            <div class="detail-group mb-3">
                                <label class="detail-label">
                                    <i class="fas fa-star"></i> Grade
                                </label>
                                <div class="detail-value-box">
                                    <span class="badge badge-primary">@(Model.Grade ?? "Not specified")</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Timeline & Status -->
                <div class="col-lg-6">
                    <div class="card shadow-sm h-100">
                        <div class="card-body">
                            <h5 class="text-gradient mb-4">
                                <i class="fas fa-clock"></i> Timeline & Status
                            </h5>
                            
                            <div class="detail-group mb-3">
                                <label class="detail-label">
                                    <i class="fas fa-calendar"></i> Required From
                                </label>
                                <div class="detail-value-box">
                                    @if (Model.RequiredFrom.HasValue)
                                    {
                                        <span class="badge badge-info">
                                            @Model.RequiredFrom?.ToString("dddd, MMMM dd, yyyy")
                                        </span>
                                    }
                                    else
                                    {
                                        <span class="text-muted">Not specified</span>
                                    }
                                </div>
                            </div>
                            
                            <div class="detail-group mb-3">
                                <label class="detail-label">
                                    <i class="fas fa-thumbs-up"></i> Client Evaluation
                                </label>
                                <div class="detail-value-box">
                                    @{
                                        var evaluationClass = Model.ClientEvaluation switch
                                        {
                                            "Yes" => "badge-success",
                                            "No" => "badge-danger",
                                            _ => "badge-warning"
                                        };
                                    }
                                    <span class="badge @evaluationClass">
                                        @(Model.ClientEvaluation ?? "No evaluation provided")
                                    </span>
                                </div>
                            </div>
                            
                            <div class="detail-group mb-3">
                                <label class="detail-label">
                                    <i class="fas fa-flag"></i> Service Order State
                                </label>
                                <div class="detail-value-box">
                                    @{
                                        var statusClass = Model.SOState switch
                                        {
                                            "Open" => "badge-success",
                                            "Closed" => "badge-danger",
                                            "InterviewSchedule Redirect Required" => "badge-warning",
                                            _ => "badge-info"
                                        };
                                    }
                                    <span class="badge @statusClass fs-6">
                                        @(Model.SOState ?? "Not specified")
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Assignment Information -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <h5 class="text-gradient mb-4">
                                <i class="fas fa-users"></i> Assignment Information
                            </h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="assignment-info">
                                        <div class="assignment-header">
                                            <i class="fas fa-user-check"></i> Assigned Resource
                                        </div>
                                        <div class="assignment-details">
                                            <strong>ID:</strong> @(Model.AssignedToResource?.ToString() ?? "Not assigned")<br>
                                            <strong>Name:</strong> @ViewBag.AssignedResourceName
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="assignment-info">
                                        <div class="assignment-header">
                                            <i class="fas fa-user-tie"></i> Hiring Manager
                                        </div>
                                        <div class="assignment-details">
                                            <strong>ID:</strong> @(Model.HiringManager?.ToString() ?? "Not assigned")<br>
                                            <strong>Name:</strong> @ViewBag.HiringManagerName
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- InterviewSchedule Redirect Section -->
            @if (ViewBag.ShowInterviewScheduleLink == true)
            {
                <div class="row mt-4">
                    <div class="col-12">
                        <div class="card shadow-sm border-warning">
                            <div class="card-body">
                                <h5 class="text-warning mb-4">
                                    <i class="fas fa-calendar-check"></i> InterviewSchedule Redirect Required
                                </h5>
                                <div class="alert alert-warning border-warning">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6><strong><i class="fas fa-exclamation-triangle"></i> Interview Scheduling Required</strong></h6>
                                            <p class="mb-2">@ViewBag.RedirectReason</p>
                                            <div class="interview-details">
                                                <span class="detail-item">
                                                    <strong>Employee:</strong> @ViewBag.EmployeeName
                                                </span>
                                                <span class="detail-item">
                                                    <strong>Status:</strong> Associate is willing and client evaluation is positive
                                                </span>
                                            </div>
                                        </div>
                                        <div class="col-md-4 text-center">
                                            <a href="@ViewBag.InterviewScheduleLink" 
                                               target="_blank" 
                                               class="btn btn-warning btn-lg shadow-sm">
                                                <i class="fas fa-external-link-alt"></i> 
                                                Schedule Interview
                                            </a>
                                            <small class="text-muted d-block mt-2">
                                                Opens InterviewSchedule app
                                            </small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }

            <!-- Action Buttons -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="d-flex gap-3 flex-wrap">
                        <a asp-action="Index" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i> Back to My Orders
                        </a>
                        <a asp-action="PriorityList" asp-route-serviceOrderId="@Model.ServiceOrderID" class="btn btn-success">
                            <i class="fas fa-list"></i> View Priority List
                        </a>
                        <a asp-controller="Home" asp-action="Index" class="btn btn-primary">
                            <i class="fas fa-home"></i> Home
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .detail-group {
        border-bottom: 1px solid #f0f0f0;
        padding-bottom: 15px;
    }
    
    .detail-label {
        font-weight: 600;
        color: #495057;
        margin-bottom: 8px;
        display: block;
        font-size: 0.9rem;
    }
    
    .detail-value-box {
        background-color: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        padding: 12px 15px;
        min-height: 45px;
        display: flex;
        align-items: center;
    }
    
    .assignment-info {
        background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 15px;
        border: 2px solid #e9ecef;
        transition: all 0.3s ease;
    }
    
    .assignment-info:hover {
        border-color: #667eea;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    .assignment-header {
        font-weight: 700;
        color: #667eea;
        margin-bottom: 10px;
        font-size: 1.1rem;
    }
    
    .assignment-details {
        color: #495057;
        line-height: 1.6;
    }
    
    .interview-details {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .interview-details .detail-item {
        background: rgba(255, 255, 255, 0.7);
        padding: 8px 12px;
        border-radius: 6px;
        font-size: 0.9rem;
    }
    
    .breadcrumb {
        background: white;
        border-radius: 10px;
        padding: 15px 20px;
        border: 1px solid #e9ecef;
    }
    
    .breadcrumb-item + .breadcrumb-item::before {
        content: ">";
        color: #667eea;
        font-weight: bold;
    }
</style>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .detail-group {
        border-bottom: 1px solid #f0f0f0;
        padding-bottom: 15px;
    }
    
    .detail-label {
        font-weight: 600;
        color: #495057;
        margin-bottom: 8px;
        display: block;
        font-size: 0.9rem;
    }
    
    .detail-value-box {
        background-color: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        padding: 12px 15px;
        min-height: 45px;
        display: flex;
        align-items: center;
    }
    
    .assignment-info {
        background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 15px;
        border: 2px solid #e9ecef;
        transition: all 0.3s ease;
    }
    
    .assignment-info:hover {
        border-color: #667eea;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    .assignment-header {
        font-weight: 700;
        color: #667eea;
        margin-bottom: 10px;
        font-size: 1.1rem;
    }
    
    .assignment-details {
        color: #495057;
        line-height: 1.6;
    }
    
    .interview-details {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .interview-details .detail-item {
        background: rgba(255, 255, 255, 0.7);
        padding: 8px 12px;
        border-radius: 6px;
        font-size: 0.9rem;
    }
    
    .breadcrumb {
        background: white;
        border-radius: 10px;
        padding: 15px 20px;
        border: 1px solid #e9ecef;
    }
    
    .breadcrumb-item + .breadcrumb-item::before {
        content: ">";
        color: #667eea;
        font-weight: bold;
    }
</style>
